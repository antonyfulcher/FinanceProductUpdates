<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Product & Analytics Team Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Base Styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .chart-container {
            position: relative; width: 100%; max-width: 500px; margin-left: auto; margin-right: auto;
            height: 300px; max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 350px; max-height: 400px; }
        }
        .nav-link { transition: all 0.2s ease-in-out; }
        .nav-link.active { color: #d97706; border-bottom-color: #d97706; }
        .kpi-card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .priority-table th {
            padding: 12px 16px; background-color: #f1f5f9; color: #1e293b; font-weight: 600;
            text-align: left; border-bottom: 2px solid #e2e8f0; border-right: 1px solid #e2e8f0; white-space: nowrap;
        }
        .priority-table td { padding: 8px 16px; border-bottom: 1px solid #e2e8f0; border-right: 1px solid #e2e8f0; vertical-align: top; }
        .priority-table th:last-child, .priority-table td:last-child { border-right: none; }
        .priority-bubble {
            display: inline-block; padding: 4px 8px; border-radius: 9999px; font-size: 0.75rem; font-weight: 500;
            margin: 2px; cursor: help; position: relative; background-color: #f1f5f9; color: #475569; border: 1px solid #e2e8f0;
        }
        /* Team Colors */
        .team-data-bi { background-color: #bfdbfe; color: #1e40af; border-color: #60a5fa; }
        .team-booking-fulfilment { background-color: #fed7aa; color: #c2410c; border-color: #fb923c; }
        .team-finance { background-color: #dcfce7; color: #16a34a; border-color: #4ade80; }
        .team-crm { background-color: #e5e5e5; color: #475569; border-color: #94a3b8; }
        .priority-top-focus { background-color: #fef3c7; border: 2px solid #f59e0b; color: #b45309; font-weight: 600; }
        /* Tooltip */
        #custom-tooltip {
            position: absolute; background-color: #1e293b; color: #f8fafc; padding: 10px 15px;
            border-radius: 8px; font-size: 0.875rem; max-width: 300px; z-index: 50;
            pointer-events: none; opacity: 0; transition: opacity 0.2s ease-in-out; transform: translateY(10px);
        }
        #custom-tooltip.visible { opacity: 1; transform: translateY(0); }
        /* Releases Section */
        .release-type-group {
            background-color: #ffffff; padding: 1.5rem; border-radius: 0.5rem;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); border: 1px solid #e2e8f0;
        }
        .release-type-group h3 {
            font-size: 1.25rem; font-weight: 700; color: #1e293b; margin-bottom: 1rem;
            border-bottom: 1px solid #f1f5f9; padding-bottom: 0.5rem;
        }
        .release-item {
            font-size: 0.875rem; color: #475569; line-height: 1.5; margin-bottom: 1.5rem;
            border-left: 3px solid #f59e0b; padding-left: 10px;
        }
        .release-item strong { font-weight: 700; color: #1e293b; display: block; margin-top: 0.25rem; }
        .key-release-star { color: #fbbf24; margin-right: 0.25rem; font-size: 1rem; vertical-align: top; line-height: 1.5; }
        .offline-marker {
            padding: 40px; background-color: #fee2e2; border: 4px solid #ef4444; 
            border-radius: 0.5rem; text-align: center; font-size: 2rem;
            font-weight: 800; color: #b91c1c; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* Strategic Progression Specific Styling */
        .progression-bar {
            background-color: #f59e0b; 
            height: 4px;
            border-radius: 9999px;
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Finance Product & Analytics Update</h1>
            <p class="text-slate-500 mt-1" id="report-period">Reporting Period: For the month of September 2025</p>
        </header>

        <div class="mb-6 flex items-center justify-between">
            <label for="month-selector" class="text-lg font-semibold text-slate-700">Select Month:</label>
            <select id="month-selector" class="bg-white border border-slate-300 rounded-lg p-2 shadow-sm text-slate-800">
                </select>
        </div>

        <nav class="bg-white rounded-lg shadow-sm mb-8 sticky top-4 z-10" id="main-nav-container">
            </nav>

        <main id="content">
            
            <section id="overview" class="content-section space-y-8">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">Period Overview</h2>
                    <p class="text-slate-600 max-w-3xl">This section provides a high-level summary of the team's performance, key achievements, and most pressing challenges from the last month. Use these metrics to get a quick understanding of our operational health and strategic momentum before diving into the detailed sections.</p>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" id="kpi-container">
                    </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-xl font-bold text-slate-900 mb-4">Key Achievements This Month</h3>
                        <ul class="space-y-3" id="key-achievements-list">
                            </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-xl font-bold text-slate-900 mb-4">Urgent: Blockers & Decisions (Current)</h3>
                           <ul class="space-y-3" id="blockers-decisions-list">
                                </ul>
                    </div>
                </div>
            </section>

            <section id="workload" class="content-section space-y-8 hidden">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">Workload Deep Dive (Monthly Analysis)</h2>
                    <p class="text-slate-600 max-w-3xl">This section analyzes the team's effort allocation across completed work in the last month. The charts below illustrate how our time is divided between strategic initiatives and operational support, which business areas are our primary partners, and the types of product releases we are delivering. <br>
                    <span class="font-semibold">Total Tickets Closed This Month: <span class="text-amber-600" id="total-tickets-closed">--</span></span></p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-xl font-bold text-slate-900 mb-4 text-center">Workload Breakdown by Type</h3>
                        <div class="chart-container"> <canvas id="workloadChart"></canvas> </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-xl font-bold text-slate-900 mb-4 text-center">Primary Requestors by Volume</h3>
                        <div class="chart-container h-[400px]"> <canvas id="requestorsChart"></canvas> </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200 col-span-1 lg:col-span-2">
                        <h3 class="text-xl font-bold text-slate-900 mb-4 text-center">Product Release Types</h3>
                        <div class="chart-container"> <canvas id="releaseTypeChart"></canvas> </div>
                    </div>
                </div>
            </section>

            <section id="strategy" class="content-section space-y-8 hidden">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">Strategic Progression</h2>
                    <p class="text-slate-600 max-w-3xl">This section tracks our progress against key strategic outcomes, demonstrating tangible improvements and performance relative to previous periods.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="text-xl font-bold text-slate-900 mb-6">Strategic Outcome Progression</h3>
                    <div class="space-y-6" id="strategic-progression-list">
                        </div>
                </div>
            </section>

            <section id="releases" class="content-section space-y-8 hidden">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2" id="releases-header">Recent Product Releases</h2>
                    <p class="text-slate-600 max-w-3xl">This section details all significant reports, dashboards, and system amendments deployed during the reporting period, grouped by the type of request. Key releases are marked with a star (⭐).</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:col-span-3 gap-6" id="release-list-container">
                    </div>
            </section>

            <section id="priorities" class="content-section space-y-8 hidden">
                </section>

            <section id="ahead" class="content-section space-y-8 hidden">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">A Look Ahead (Upcoming Period)</h2>
                    <p class="text-slate-600 max-w-3xl">This section details tickets that are currently in progress, prioritized, or selected for development for the upcoming month.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200" id="look-ahead-content">
                    </div>
            </section>
        </main>

    </div>

    <script>
        // --- CONSOLIDATED DATA FOR ALL MONTHS ---
        const ALL_MONTHLY_DATA = {
            "SEP2025": { // LATEST MONTH (OFFLINE STRATEGY)
                reportDate: "September 2025",
                kpis: { strategicTactical: "58%", avgCompletion: "29", totalReleases: "28", activeBlockers: "4" },
                kpiAvgCompletionUnit: "days",
                nextMonthHeader: "October 2025",
                prioritiesSummary: "Finalising Projects around operational efficiencies and pipeline reporting, removal of finance cost to serve tasks due to blockers. Overrides likely moving to October.",
                navLinksHTML: `
                    <ul class="flex flex-wrap border-b border-slate-200">
                        <li><a href="#overview" class="nav-link active text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Overview</a></li>
                        <li><a href="#workload" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Workload Deep Dive</a></li>
                        <li><a href="#strategy" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Strategic Progression</a></li>
                        <li><a href="#releases" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Product Releases</a></li>
                        <li><a href="#priorities" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Priorities</a></li>
                    </ul>
                `,
                prioritiesContentHTML: `
                    <div>
                        <h2 class="text-2xl font-bold text-slate-900 mb-2" id="priorities-header">Priorities for the Coming Period (October 2025)</h2>
                        <p class="text-slate-600 max-w-3xl font-semibold" id="priorities-summary">Finalising Projects around operational efficiencies and pipeline reporting, removal of finance cost to serve tasks due to blockers. Overrides likely moving to October.</p>
                        <p class="text-slate-600 max-w-3xl">These are the key objectives the team will focus on in the upcoming month to drive strategic progress and deliver value, aligned with our overarching company and finance goals. This consolidated view provides a quick understanding of our strategic focus. Hover over a priority name for more details.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200 overflow-x-auto">
                        <table class="w-full text-left border-collapse priority-table">
                            <thead>
                                <tr>
                                    <th class="w-[15%]">Company Goal</th>
                                    <th class="w-[14%]">Working Capital</th>
                                    <th class="w-[14%]">Overhead Automation</th>
                                    <th class="w-[14%]">Report Automation</th>
                                    <th class="w-[14%]">People Focus</th>
                                    <th class="w-[14%]">Margin Control</th>
                                    <th class="w-[14%]">Efficiency Enhancement</th>
                                    <th class="w-[13%]">Team</th> 
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                `,
                strategicProgression: null, // Signals the use of the OFF-LINE marker in JS
                achievements: [
                    { summary: "Finalised Our Q4 Roadmap with a key priority being resolving issues around the Invoice Uploads Report", description: "Finalised Our Q4 Roadmap with a key priority being resolving issues around the Invoice Uploads Report" },
                    { summary: "TIG Travel Ledger Release - Testing Period finalised as of end of September, full release in October", description: "TIG Travel Ledger Release - Testing Period finalised as of end of September, full release in October" },
                    { summary: "Offline Ancillary Invoice Automation Succesful relelease and now complete.", description: "Offline Ancillary Invoice Automation Succesful relelease and now complete." },
                    { summary: "Tableau Data Sources Cretaed to Aid Enett & Bank Reconciliations, as well as opening payment position project.", description: "Tableau Data Sources Cretaed to Aid Enett & Bank Reconciliations, as well as opening payment position project." },
                    { summary: "Successful Transition to New Supplier Payments Data Sources - All supplier payment reports no longer inhibted by performance", description: "Successful Transition to New Supplier Payments Data Sources - All supplier payment reports no longer inhibted by performance" },
                    { summary: "Weekly & Monthly Data Capture of Pipeline Cash Established.", description: "Weekly & Monthly Data Capture of Pipeline Cash Established." }
                ],
                blockers: [
                    { type: "❗", title: "Action Required: Supplier Driven Changes have a signifcant knock-on effect, namely P&O PPN Processing, as well as issues arising around virgin voyages.", description: "Action Required: Supplier Driven Changes have a signifcant knock-on effect, namely P&O PPN Processing, as well as issues arising around virgin voyages." },
                    { type: "❗", title: "Action Required: Follow-up Meeting required to begin splitting 2026 strategic initiatives into first and second halves of the year.", description: "Action Required: Follow-up Meeting required to begin splitting 2026 strategic initiatives into first and second halves of the year." },
                    { type: "❓", title: "Decision Required: SAFI Deployment has been delayed and needs a hypothesis statement produced to coordinate efforts.", description: "Decision Required: SAFI Deployment has been delayed and needs a hypothesis statement produced to coordinate efforts." },
                    { type: "❗", title: "Action Required: Pipeline Report Delayed due to availability of Dan Clay to finalise tableau data sources.", description: "Action Required: Pipeline Report Delayed due to availability of Dan Clay to finalise tableau data sources." }
                ],
                jira: {
                    workloadLabels: ["BAU", "Strategic Work", "Non Strategic Project", "Operational Essential"], workloadCounts: [19, 7, 1, 1],
                    requestorLabels: ["Transactional Processing", "None", "Reconciliation", "Compliance", "FP&A", "Lorna Vincent", "IT"], requestorCounts: [12, 8, 4, 1, 1, 1, 1],
                    releaseTypeLabels: ["Report Amendment", "Bug Investigation", "New Report", "Support", "Manual Report", "Insights", "Maintenance"], releaseTypeCounts: [7, 7, 5, 5, 2, 1, 1],
                    releases: [{"Summary": "INC0064124 - Remove Added Benefit Discount From Tableau Report", "Requestor": "Compliance", "Created Date": "27/06/2025", "Resolved Date": "29/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Create SQL Table for Pre-Paywise Bank Statements with Cashflow Allocation and Statement Number Fields", "Requestor": "Transactional Processing", "Created Date": "22/05/2025", "Resolved Date": "29/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "New Report", "is_key_release": true}, {"Summary": "Create Pre-Paywise Enett Excel with Supplier Reference and Booking ID", "Requestor": "Transactional Processing", "Created Date": "22/05/2025", "Resolved Date": "29/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "New Report", "is_key_release": false}, {"Summary": "Travel Ledger Notifications Present Wrong Values", "Requestor": "Transactional Processing", "Created Date": "29/09/2025", "Resolved Date": "29/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Build Offline Ancillary Invoice Automation Sproc", "Requestor": "None", "Created Date": "27/08/2025", "Resolved Date": "29/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "Support", "is_key_release": true}, {"Summary": "Offline Invoice Automation Testing", "Requestor": "None", "Created Date": "26/08/2025", "Resolved Date": "29/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "Support", "is_key_release": false}, {"Summary": "Native Invoice Value Vary Between DM and DWH", "Requestor": "Reconciliation", "Created Date": "17/07/2025", "Resolved Date": "26/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Rebuild Invoice Insights Dashboard", "Requestor": "Transactional Processing", "Created Date": "02/09/2025", "Resolved Date": "23/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "New Report", "is_key_release": true}, {"Summary": "INC0063804 - BookingAPI OBC Discrepancy ", "Requestor": "Transactional Processing", "Created Date": "03/06/2025", "Resolved Date": "18/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Bring dbo.TransportInvoiceInformation into datawarehouse", "Requestor": "None", "Created Date": "27/08/2025", "Resolved Date": "16/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "Support", "is_key_release": false}, {"Summary": "Invoice Automations Failure - 15/09", "Requestor": "None", "Created Date": "15/09/2025", "Resolved Date": "15/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Fix Supplier Payments / Transaction List", "Requestor": "Transactional Processing", "Created Date": "02/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Doddle Support - Use of Booking Snapshot Priority Codes in Auto-Pay", "Requestor": "Transactional Processing", "Created Date": "03/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Doddle Support - Not Matching On Surname", "Requestor": "Transactional Processing", "Created Date": "10/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Travel Ledger Statements with Incorrect Payment Statuses", "Requestor": "Reconciliation", "Created Date": "10/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Reconciliation Report - Missing Payment Data", "Requestor": "Reconciliation", "Created Date": "09/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "New Report", "is_key_release": false}, {"Summary": "Reconciliation Report - Incorrect Payment Data", "Requestor": "Reconciliation", "Created Date": "09/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "New Report", "is_key_release": false}, {"Summary": "Reconciliation Report - New Statement Data", "Requestor": "Reconciliation", "Created Date": "09/09/2025", "Resolved Date": "12/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "New Report", "is_key_release": false}, {"Summary": "Build Tableau Data Source for Supplier Invoices", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "09/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "Support", "is_key_release": false}, {"Summary": "Review Data Flow - Paywise to Reconciliation", "Requestor": "None", "Created Date": "27/08/2025", "Resolved Date": "09/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "Support", "is_key_release": false}, {"Summary": "Paywise Commission Reconcilliation View", "Requestor": "None", "Created Date": "27/08/2025", "Resolved Date": "09/09/2025", "Work Type": "Strategic Work", "Story Points": 0, "Request Type": "Support", "is_key_release": false}, {"Summary": "FP&A Monthly Report - AUG25", "Requestor": "FP&A", "Created Date": "09/09/2025", "Resolved Date": "09/09/2025", "Work Type": "Operational Essential", "Story Points": 0, "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "Create Tableau View for Supplier Statement Reconciliation", "Requestor": "Transactional Processing", "Created Date": "02/09/2025", "Resolved Date": "06/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Paywise Recon - Update Statement Date Field", "Requestor": "Transactional Processing", "Created Date": "02/09/2025", "Resolved Date": "06/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Add Payment Gateway Data to Reconciliation Report", "Requestor": "Lorna Vincent", "Created Date": "02/09/2025", "Resolved Date": "06/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Finalise Report Subscription Automation", "Requestor": "IT", "Created Date": "02/09/2025", "Resolved Date": "06/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Manual Data Entry for Commission Reconciliation", "Requestor": "None", "Created Date": "01/09/2025", "Resolved Date": "01/09/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "INC0062588 - Missing Identical Payments in dbo.v_Reporting for Direct & eNett Transactions", "Requestor": "Transactional Processing", "Created Date": "19/04/2025", "Resolved Date": "28/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false}]
                },
                priorities: [
                    {"Company Goal": "Cross-functional / Finance Specific", "Working Capital": {"name": "Pipeline Reporting - Finalise Launch of V1 Pipeline Monies, cash flow reporitng to follow in a later month.", "description": "Pipeline Reporting - Finalise Launch of V1 Pipeline Monies, cash flow reporitng to follow in a later month.", "team": "Data & BI", "isTopFocus": true}, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Gain Efficiency", "Working Capital": null, "Overhead Automation": null, "Report Automation": {"name": "Invoice Uploads Report - Collab Work Group Established Weekly - Investigation Underway", "description": "Invoice Uploads Report - Collab Work Group Established Weekly - Investigation Underway", "team": "Finance"}, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": {"name": "Booking Efficencies - Establish AutoPay Dashboards and aid the discovery of booking effiencies, via reporting and improvement suggestion.", "team": "Booking & Fulfilment"}},
                    {"Company Goal": "Increase Margin", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": {"name": "Establish SAFI - Create Hypothesis Statements & Plan Work", "description": "Establish SAFI - Create Hypothesis Statements & Plan Work", "team": "CRM"}, "Efficiency Enhancement": null},
                    {"Company Goal": "Go Global", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Growing Online", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Put People First", "Working Capital": null, "Overhead Automation": null, "Report Automation": {"name": "Tableau Organisation - Conduct an exercise to clean up tableau enviorment and document finance use cases", "description": "Tableau Organisation - Conduct an exercise to clean up tableau enviorment and document finance use cases", "team": "Finance"}, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Build Loyalty", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": {"name": "Supplier Opening Position - Finalise Work to improve the data quality of the opening position, aid payment decisions.", "description": "Supplier Opening Position - Finalise Work to improve the data quality of the opening position, aid payment decisions.", "team": "Finance"}}
                ]
            },
            "AUG2025": { // PREVIOUS MONTH
                reportDate: "August 2025",
                kpis: { strategicTactical: "65%", avgCompletion: "37", totalReleases: "34", activeBlockers: "1" }, // Corrected Total Releases KPI to 34
                kpiAvgCompletionUnit: "days",
                nextMonthHeader: "September 2025",
                prioritiesSummary: "Finalising Projects around operational efficiencies and pipeline reporting, removal of finance cost to serve tasks due to blockers. Overrides likely moving to September.",
                navLinksHTML: `
                    <ul class="flex flex-wrap border-b border-slate-200">
                        <li><a href="#overview" class="nav-link active text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Overview</a></li>
                        <li><a href="#workload" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Workload Deep Dive</a></li>
                        <li><a href="#strategy" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Strategic Progression</a></li>
                        <li><a href="#releases" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Product Releases</a></li>
                        <li><a href="#priorities" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Priorities</a></li>
                        <li><a href="#ahead" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">A Look Ahead</a></li>
                    </ul>
                `,
                prioritiesContentHTML: `
                    <div>
                        <h2 class="text-2xl font-bold text-slate-900 mb-2" id="priorities-header">Priorities for the Coming Period (September 2025)</h2>
                        <p class="text-slate-600 max-w-3xl font-semibold" id="priorities-summary">Finalising Projects around operational efficiencies and pipeline reporting, removal of finance cost to serve tasks due to blockers. Overrides likely moving to September.</p>
                        <p class="text-slate-600 max-w-3xl">These are the key objectives the team will focus on in the upcoming month to drive strategic progress and deliver value, aligned with our overarching company and finance goals. This consolidated view provides a quick understanding of our strategic focus. Hover over a priority name for more details.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200 overflow-x-auto">
                        <table class="w-full text-left border-collapse priority-table">
                            <thead>
                                <tr>
                                    <th class="w-[15%]">Company Goal</th>
                                    <th class="w-[14%]">Working Capital</th>
                                    <th class="w-[14%]">Overhead Automation</th>
                                    <th class="w-[14%]">Report Automation</th>
                                    <th class="w-[14%]">People Focus</th>
                                    <th class="w-[14%]">Margin Control</th>
                                    <th class="w-[14%]">Efficiency Enhancement</th>
                                    <th class="w-[13%]">Team</th> 
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                `,
                strategicProgression: [
  
                    { name: "Auto Invoice", current: 32, previous: 28, lastYear: 28, type: "percentage", improvement: "Moved from 29% last month to 28% this month (32% this month last year)." },
                    { name: "Auto Invoice @ Completion", current: 44, previous: 39, lastYear: null, type: "percentage", improvement: "Moved from 41% last month to 40% this month." },
                    { name: "Travel Ledger Processed Volume", current: 65, previous: 48, lastYear: null, type: "percentage", improvement: "Down to 48% from 64% in June and 71% in May due to missed statements." }
                ],
                achievements: [
                    { summary: "Non-Attempt API Reporting", description: "Finalised Reporting to hep indicate why we didn't book via API, solidifying a list of actions to improve and grow online." },
                    { summary: "Agreed TIG Travel Ledger Start Date", description: "Agreed with TIG to start processing supplier payments on Travel Ledger rather than daily direct debit." },
                    { summary: "Invoice Automation Process Adapted for Late Bookings", description: "Deployment from late July was succesful towards the end of August, seen a positive uptake in invoice automation %" },
                    { summary: "Paywise Reporting Uphaul", description: "Previously unavailable content has been made available, Supplier Payment Reporting Views have been cleansed and rebuilt and will be replacing existing sources in early September. (Eliminating previously prohibitive performance issues)" },
                    { summary: "Pipeline Reporting", description: "Performance issues have been resolved, V1 Reporting has now been built as we're now capable of capturing pipeline position at month-end." },
                    { summary: "Offline Ancillary invoice Automation", description: "Succesfull testing cycle of offline ancillary invoice automation, anticipating a deploy early September." }
                ],
                blockers: [
                    { type: "❓", title: "Decision Required: Align Finance Goals with Company Strategy", description: "A clear definition of finance-specific goals is needed to ensure alignment with overall company strategy for Q4 and 2026, enabling the finalization and agreement of a development roadmap with IT. This decision requires input from Lorna Vincent and Antony Fulcher." },
                    { type: "❗", title: "Action Required: Clarity around remaining pipeline reporting requirements now that we're capable from a performance perspective.", description: "Clarity around remaining pipeline reporting requirements now that we're capable from a performance perspective." }
                ],
                jira: {
                    workloadLabels: ["BAU", "Strategic Work", "Non Strategic Project", "Operational Essential"], workloadCounts: [19, 1, 6, 1],
                    requestorLabels: ["Transactional Processing", "None", "Reconciliation", "IT", "Lorna Vincent", "Compliance", "FP&A", "Nancy Emery"], requestorCounts: [12, 6, 2, 2, 3, 1, 1, 1],
                    releaseTypeLabels: ["Bug Investigation", "New Report", "Report Amendment", "Support", "Manual Report", "Insights", "Maintenance"], releaseTypeCounts: [9, 8, 5, 4, 3, 2, 1],
                    // Full list of 34 releases for August (used by populateReleases)
                    releases: [{"Summary": "BookingAPI Not Attempt Reason Reporting", "Requestor": "IT", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 9, "Request Type": "New Report", "is_key_release": true}, {"Summary": "Non GBP Payments Reporting", "Requestor": "Lorna Vincent", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 2, "Request Type": "New Report", "is_key_release": false}, {"Summary": "Understand Our Current TIG Risk Profile", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 3, "Request Type": "New Report", "is_key_release": false}, {"Summary": "Rebuild Paywise Views", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 54, "Request Type": "New Report", "is_key_release": true}, {"Summary": "Finance Stateholder Updates", "Requestor": "Nancy Emery", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 6, "Request Type": "Insights", "is_key_release": false}, {"Summary": "Move Invoice Automation To Staging Schema", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Strategic Work", "Story Points": 10, "Request Type": "Report Amendment", "is_key_release": true}, {"Summary": "Travel Ledger - FTP Upload Duplication", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Barclaycard - TM Payment Query", "Requestor": "Lorna Vincent", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Operational Essential", "Story Points": 3, "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Daily - Load Direct Payment & RCL Groups", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 3.5, "Request Type": "Support", "is_key_release": false}, {"Summary": "Supplier Payment - Cash Flow Reporting", "Requestor": "Lorna Vincent", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 3, "Request Type": "Manual Report", "is_key_release": false},
                    {"Summary": "Check Invoice Automation Change Records", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 1, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Add SoftCash Fields to Tableau", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 1, "Request Type": "Report Amendment", "is_key_release": false},
                    {"Summary": "INC0064768 - Insurance report not returning data for July", "Requestor": "Compliance", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Operational Essential", "Story Points": 1, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "INC0064713 - Enett Statement Failing To Process BI", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Multi Occupancy Ambassador Costs Not Loaded", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Doddle Support: Paywise Auto-Pay Failure During Statement Import", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Paywise: Travel Ledger and eNett Reconciliation 2.0", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 2, "Request Type": "Support", "is_key_release": false},
                    {"Summary": "Doddle Support - Payment Search Duplication", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Doddle Support - eNett statement failing at import stage", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Doddle Support - Duplicate Travel Ledger imports", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Doddle Support: eNett: Failing at Import Stage", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Replace eNetts in Payment Gold", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 6, "Request Type": "Maintenance", "is_key_release": false},
                    {"Summary": "Commission Report for Retail and TM Bookings", "Requestor": "Reconciliation", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "New Report", "is_key_release": false},
                    {"Summary": "Report for Auto-Paid Transactions in Paywise where Commissions Differ", "Requestor": "Reconciliation", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 2, "Request Type": "New Report", "is_key_release": false},
                    {"Summary": "INC0062588- Missing Identical Payments in dbo.v_Reporting for Direct & eNett Transactions", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Bug Investigation", "is_key_release": false},
                    {"Summary": "Paywise: Travel Ledger and eNett Reconciliation", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "Support", "is_key_release": false},
                    {"Summary": "REQ0020387 - Add Product Type Tracking to DM Bookings At Completion", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false},
                    {"Summary": "Cost Item Expected Commission Values", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Report Amendment", "is_key_release": false},
                    {"Summary": "Booking Shares Reporting", "Requestor": "IT", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "New Report", "is_key_release": false},
                    {"Summary": "Setup AutoPayDecision Reporting Subscriptions", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 6, "Request Type": "New Report", "is_key_release": false},
                    {"Summary": "Gross Pipeline 1st Jan - 30th June 2025", "Requestor": "Lorna Vincent", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Operational Essential", "Story Points": 8, "Request Type": "New Report", "is_key_release": false},
                    {"Summary": "NULL Ledger Codes", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 5, "Request Type": "Insights", "is_key_release": false},
                    {"Summary": "Direct Payments Movements", "Requestor": "Transactional Processing", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "Manual Report", "is_key_release": false},
                    {"Summary": "FP&A Monthly Report - JUL25", "Requestor": "FP&A", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "BAU", "Story Points": 1, "Request Type": "Manual Report", "is_key_release": false},
                    {"Summary": "Rebuild Paywise Views - Complete", "Requestor": "None", "Created Date": "29/08/2025", "Resolved Date": "29/08/2025", "Work Type": "Non Strategic Project", "Story Points": 54, "Request Type": "Report Amendment", "is_key_release": true}
                ]},
                priorities: [
                    {"Company Goal": "Cross-functional / Finance Specific", "Working Capital": {"name": "Finalize Pipeline Monies Reporting", "description": "Finalize Pipeline Monies Reporting: Ensure accurate reporting of pipeline monies position by finalizing dataset testing and report development.", "team": "Data & BI", "isTopFocus": true}, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Gain Efficiency", "Working Capital": null, "Overhead Automation": {"name": "Offline Ancillary Invoice Automation", "description": "Offline Ancillary Invoice Automation: Build a process to capture api responses for ancillaries that were booked online, ensuring we can still automatically invoice.", "team": "Finance"}, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": {"name": "Enhance Paywise Data & Performance", "description": "Enhance Paywise Data & Performance: Improve Paywise data availability, reporting view speed, and content for users.", "team": "Data & BI"}},
                    {"Company Goal": "Go Global", "Working Capital": null, "Overhead Automation": {"name": "Improve Booking Success Rate", "description": "Improve Booking Success Rate: Utilise Reporting to identify reasons for failed/unattempted bookings, aiming to increase API booking percentage and invoice automation.", "team": "Finance"}, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Growing Online", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Put People First", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": {"name": "Launch Staff Circle", "description": "Launch Staff Circle within Finance Product: Initiate the Staff Circle program to prioritize people-centric initiatives within the team.", "team": "Finance"}, "Margin Control": null, "Efficiency Enhancement": null},
                    {"Company Goal": "Increase Margin", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": {"name": "Report On-Invoice Override Commissions", "description": "Report On-Invoice Override Commissions: Develop reports to highlight instances where on-invoice override commissions were not loaded, to minimize dilution and identify potential overpayments.", "team": "Finance"}, "Efficiency Enhancement": null},
                    {"Company Goal": "Build Loyalty", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null}
                ],
                ahead: [
                    { status: "In Progress", items: [{"key": "FCP-459", "summary": "Doddle Support - Transactions Not Assigned to a Booking ID", "created": "22/08/2025"}, {"key": "FCP-438", "summary": "Improve Opening Position Banking Fields", "created": "07/08/2025"}, {"key": "FCP-473", "summary": "Bring dbo.TransportInvoiceInformation into datawarehouse", "created": "27/08/2025"}, {"key": "FCP-467", "summary": "Offline Invoice Automation Testing", "created": "26/08/2025"}, {"key": "FCP-429", "summary": "Doddle Support: Payment On Account Bugs", "created": "02/08/2025"}, {"key": "FCP-388", "summary": "INC0064139 - User Name Change Resulted In Lost Flexi Access", "created": "27/06/2025"}]},
                    { status: "Testing", items: [{"key": "FCP-449", "summary": "Cost & Discount Report Query", "created": "19/08/2025"}]},
                    { status: "In Code Review", items: [{"key": "FCP-432", "summary": "Build Pipeline Monies Tableau View", "created": "04/08/2025"}]},
                    { status: "Prioritised", items: [{"key": "FCP-474", "summary": "Build Offline Ancillary Invoice Automation Sproc", "created": "27/08/2025"}, {"key": "FCP-194", "summary": "Relaunch On-Invoice Override Monitoring", "created": "07/03/2025"}, {"key": "FCP-357", "summary": "Create SQL Table for Pre-Paywise Bank Statements with Cashflow Allocation and Statement Number Fields", "created": "22/05/2025"}, {"key": "FCP-480", "summary": "Paywise: Travel Ledger and eNett Reconciliation 3.0", "created": "29/08/2025"}, {"key": "FCP-439", "summary": "Source Data for Missing Supplier Payments", "created": "07/08/2025"}, {"key": "FCP-478", "summary": "Transition Supplier Payment Reporting To New Source", "created": "28/08/2025"}, {"key": "FCP-379", "summary": "Multi Occupancy Price Rounding", "created": "17/06/2025"}]},
                    {"status": "Selected for Development", "items": [{"key": "FCP-441", "summary": "Add MonthToMonth Summary of Invoice Automation", "created": "11/08/2025"}, {"key": "FCP-470", "summary": "NULL Brand Codes for Directs", "created": "26/08/2025"}, {"key": "FCP-479", "summary": "Follow up on travel ledger outbounding 2.0", "created": "28/08/2025"}, {"key": "FCP-469", "summary": "Finance Capability Assesment", "created": "26/08/2025"}]},
                    {"status": "Planned", "items": [{"key": "FCP-475", "summary": "TIG Travel Ledger Launch", "created": "27/08/2025"}, {"key": "FCP-472", "summary": "Monthly Pipeline Extract Aug", "created": "27/08/2025"}, {"key": "FCP-414", "summary": "Native Invoice Value Vary Between DM and DWH", "created": "17/07/2025"}]}
                ]
            },
            "JUL2025": { // JULY MONTH
                reportDate: "July 2025",
                kpis: { strategicTactical: "19%", avgCompletion: "21", totalReleases: "31", activeBlockers: "1" },
                kpiAvgCompletionUnit: "days",
                nextMonthHeader: "August 2025",
                prioritiesSummary: "These are the key objectives the team will focus on in the upcoming month to drive strategic progress and deliver value, aligned with our overarching company and finance goals. This consolidated view provides a quick understanding of our strategic focus. Hover over a priority name for more details.",
                navLinksHTML: `
                    <ul class="flex flex-wrap border-b border-slate-200">
                        <li><a href="#overview" class="nav-link active text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Overview</a></li>
                        <li><a href="#workload" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Workload Deep Dive</a></li>
                        <li><a href="#strategy" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Strategic Progression</a></li>
                        <li><a href="#releases" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Product Releases</a></li>
                        <li><a href="#priorities" class="nav-link text-sm md:text-base font-semibold p-4 inline-block border-b-2 border-transparent hover:bg-slate-50">Priorities</a></li>
                    </ul>
                `,
                prioritiesContentHTML: `
                    <div>
                        <h2 class="text-2xl font-bold text-slate-900 mb-2" id="priorities-header">Priorities for the Coming Period (August 2025)</h2>
                        <p class="text-slate-600 max-w-3xl font-semibold" id="priorities-summary">These are the key objectives the team will focus on in the upcoming month to drive strategic progress and deliver value, aligned with our overarching company and finance goals. This consolidated view provides a quick understanding of our strategic focus. Hover over a priority name for more details.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200 overflow-x-auto">
                        <table class="w-full text-left border-collapse priority-table">
                            <thead>
                                <tr>
                                    <th class="w-[15%]">Company Goal</th>
                                    <th class="w-[14%]">Working Capital</th>
                                    <th class="w-[14%]">Overhead Automation</th>
                                    <th class="w-[14%]">Report Automation</th>
                                    <th class="w-[14%]">People Focus</th>
                                    <th class="w-[14%]">Margin Control</th>
                                    <th class="w-[14%]">Efficiency Enhancement</th>
                                    <th class="w-[13%]">Team</th> 
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                `,
                strategicProgression: [
                    { name: "Auto Pay", current: 84, previous: 84, lastYear: 17, type: "percentage", improvement: "Remained at 84% following last month." },
                    { name: "Auto Invoice", current: 28, previous: 29, lastYear: 32, type: "percentage", improvement: "Moved from 29% last month to 28% this month (32% this month last year)." },
                    { name: "Auto Invoice @ Completion", current: 40, previous: 41, lastYear: null, type: "percentage", improvement: "Moved from 41% last month to 40% this month." },
                    { name: "Travel Ledger Processed Volume", current: 48, previous: 64, lastYear: null, type: "percentage", improvement: "Down to 48% from 64% in June and 71% in May due to missed statements." }
                ],
                achievements: [
                    { summary: "Streamlined Ski Supplier Outbounding & Travel Ledger Efficiency", description: "Collaborated with Ski to outbound all suppliers, establishing an efficient tracking process, and work with Travel Ledger to identify efficiency gaps for future improvements." },
                    { summary: "Invoice Automation Process Adapted for Late Bookings", description: "Adapted the invoice automation process to handle late evening bookings; deployment approval is pending." },
                    { summary: "New Tableau Data Source for Supplier Invoices", description: "Established a new Tableau data source for supplier invoice detail, leading to the closure of several related tickets." },
                    { summary: "Paywise Reporting Support Plan Agreed", description: "A two-sprint period has been agreed upon with Data & BI to address support needs for Paywise reporting." }
                ],
                blockers: [
                    { type: "❗", title: "Dependency: Critical Path on Dan Clay", description: "Multiple workstreams are critically dependent on Dan Clay, including efforts outside of standard project deliverables." },
                    { type: "❓", title: "Decision Required: Align Finance Goals with Company Strategy", description: "A clear definition of finance-specific goals is needed to ensure alignment with overall company strategy for Q4 and 2026, enabling the finalization and agreement of a development roadmap with IT. This decision requires input from Lorna Vincent and Antony Fulcher." },
                    { type: "⚠️", title: "Risk Mitigation: August Focus on Strategic Work", description: "A key risk for August is that both development teams are committing to a wide spread of work with substantial value. It is crucial to ensure that the Finance Product team can maintain its focus on strategic initiatives." }
                ],
                jira: {
                    workloadLabels: ["BAU", "Strategic Work", "Non Strategic Project", "Operational Essential"], workloadCounts: [15, 3, 3, 3],
                    requestorLabels: ["Transactional Processing", "Reconciliation", "None", "Lorna Vincent", "Compliance", "Customer Care", "Sales"], requestorCounts: [8, 5, 4, 3, 2, 1, 1],
                    releaseTypeLabels: ["Bug Investigation", "New Report", "New Data Source", "Manual Report", "Insights", "Report Amendment", "Maintenance", "Support"], releaseTypeCounts: [6, 7, 2, 4, 2, 3, 1, 1],
                    releases: [{"Summary": "INC0064222 - Duplicated Invoice Load", "Requestor": "Transactional Processing", "Created Date": "02/07/2025", "Resolved Date": "08/07/2025", "Work Type": "BAU", "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "SKI TM Customer Payments", "Requestor": "Transactional Processing", "Created Date": "04/06/2025", "Resolved Date": "17/06/2025", "Work Type": "BAU", "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "INC0063787 - Duplicated Records in DWH ETL from dbo.invoice", "Requestor": "Transactional Processing", "Created Date": "03/06/2025", "Resolved Date": "18/06/2025", "Work Type": "BAU", "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Customer are incorrectly being charged fees on their payment plans", "Requestor": "Transactional Processing", "Created Date": "07/05/2025", "Resolved Date": "21/07/2025", "Work Type": "BAU", "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "Document Travel Ledger Auto Pay Fields", "Requestor": "None", "Created Date": "15/07/2025", "Resolved Date": "24/07/2025", "Work Type": "BAU", "Request Type": "Insights", "is_key_release": false}, {"Summary": "Create Pre-Paywise Enett Excel with Supplier Reference and Booking ID", "Requestor": "None", "Created Date": "22/05/2025", "Resolved Date": "02/07/2025", "Work Type": "BAU", "Request Type": "Insights", "is_key_release": false}, {"Summary": "Aldo Zilli Group Query", "Requestor": "Reconciliation", "Created Date": "14/07/2025", "Resolved Date": "21/07/2025", "Work Type": "BAU", "Request Type": "Support", "is_key_release": false}, {"Summary": "Stop FTP imports of Enett data to SupplierPayment.dbo.payment_gold", "Requestor": "None", "Created Date": "25/06/2025", "Resolved Date": "02/07/2025", "Work Type": "BAU", "Request Type": "Maintenance", "is_key_release": false}, {"Summary": "Tracey - Expected Commissions Report Rerun", "Requestor": "Reconciliation", "Created Date": "01/07/2025", "Resolved Date": "02/07/2025", "Work Type": "BAU", "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "Create Tableau Data Source for Active Invoice Values By Supplier Reference", "Requestor": "Transactional Processing", "Created Date": "01/04/2025", "Resolved Date": "24/06/2025", "Work Type": "BAU", "Request Type": "New Data Source", "is_key_release": true}, {"Summary": "Bonus Commission Report", "Requestor": "Reconciliation", "Created Date": "23/07/2025", "Resolved Date": "23/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": true}, {"Summary": "Protected Commissions report", "Requestor": "Reconciliation", "Created Date": "22/07/2025", "Resolved Date": "22/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": true}, {"Summary": "Accounts Self-Bill V2", "Requestor": "Transactional Processing", "Created Date": "23/07/2025", "Resolved Date": "24/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": true}, {"Summary": "Expected Commissions Report - Self-Service", "Requestor": "Reconciliation", "Created Date": "15/07/2025", "Resolved Date": "16/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": false}, {"Summary": "Setup Sustainable VAT/Commission Errors Report - Invoicing", "Requestor": "Transactional Processing", "Created Date": "23/06/2025", "Resolved Date": "02/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": false}, {"Summary": "Failed Tokenised Payments Report", "Requestor": "Customer Care", "Created Date": "20/05/2025", "Resolved Date": "11/06/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": false}, {"Summary": "Create Multi-Currency Bookings Report", "Requestor": "Reconciliation", "Created Date": "04/04/2025", "Resolved Date": "02/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": false}, {"Summary": "Build a report to track commission refunds from Virgin Voyages", "Requestor": "Reconciliation", "Created Date": "26/03/2025", "Resolved Date": "02/07/2025", "Work Type": "BAU", "Request Type": "New Report", "is_key_release": false}, {"Summary": "QA Update Form - Scoring Issue", "Requestor": "Sales", "Created Date": "23/06/2025", "Resolved Date": "24/06/2025", "Work Type": "BAU", "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Invoicing OT - KPI Workbook Support", "Requestor": "Transactional Processing", "Created Date": "10/06/2025", "Resolved Date": "11/06/2025", "Work Type": "BAU", "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Build Dynamic Pending Tab in INR Report with Weekly Breakdown and Stats Summary", "Requestor": "Transactional Processing", "Created Date": "16/05/2025", "Resolved Date": "24/06/2025", "Work Type": "BAU", "Request Type": "Report Amendment", "is_key_release": false}, {"Summary": "Reconcile and Correct RCL Group ID: 2642058", "Requestor": "Reconciliation", "Created Date": "26/06/2025", "Resolved Date": "26/06/2025", "Work Type": "BAU", "Story Points": 0, "Request Type": "Support", "is_key_release": false}, {"Summary": "Share Tracker Update with Travel Ledger", "Requestor": "None", "Created Date": "27/06/2025", "Resolved Date": "15/07/2025", "Work Type": "Non Strategic Project", "Request Type": "Insights", "is_key_release": false}, {"Summary": "Provide Cashflow Report Update - JUN 25", "Requestor": "Lorna Vincent", "Created Date": "08/07/2025", "Resolved Date": "09/07/2025", "Work Type": "Non Strategic Project", "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "Doddle Support Ticket - Payment Search Slowness", "Requestor": "Transactional Processing", "Created Date": "22/04/2025", "Resolved Date": "27/06/2025", "Work Type": "Operational Essential", "Request Type": "Bug Investigation", "is_key_release": false}, {"Summary": "CAA RCN Return - Monthly", "Requestor": "Compliance", "Created Date": "30/06/2025", "Resolved Date": "14/07/2025", "Work Type": "Operational Essential", "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "Quarterly Stats - LV 160725", "Requestor": "Lorna Vincent", "Created Date": "16/07/2025", "Resolved Date": "16/07/2025", "Work Type": "Strategic Work", "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "Board Cashflow Report - 08 Jul 25", "Requestor": "Lorna Vincent", "Created Date": "08/07/2025", "Resolved Date": "09/07/2025", "Work Type": "Strategic Work", "Request Type": "Manual Report", "is_key_release": false}, {"Summary": "Estabish Tableau Data Source for Finance KPI Workbook", "Requestor": "None", "Created Date": "11/06/2025", "Resolved Date": "11/06/2025", "Work Type": "Strategic Work", "Request Type": "New Data Source", "is_key_release": true}]
                },
                priorities: [
                    { "Company Goal": "Cross-functional / Finance Specific", "Working Capital": { "name": "Pipeline Monies Reporting", "description": "Finalize Pipeline Monies Reporting: Ensure accurate reporting of pipeline monies position by finalizing dataset testing and report development.", "team": "Data & BI", "isTopFocus": true }, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null },
                    { "Company Goal": "Gain Efficiency", "Working Capital": null, "Overhead Automation": [ { "name": "Late Booking Invoicing", "description": "Automate Late Evening Booking Invoicing: Deploy July's work to enable automatic invoicing for late evening bookings.", "team": "Finance" }, { "name": "Offline Ancillary Automation", "description": "Offline Ancillary Invoice Automation: Build a process to capture API responses for ancillaries that were booked online, ensuring we can still automatically invoice.", "team": "Finance" } ], "Report Automation": { "name": "Cost-to-Serve Dashboard", "description": "Establish Finance Cost-to-Serve Dashboard: Build an automated dashboard to provide a tangible metric to monitor our progress with our efficiency enhancements.", "team": "Finance" }, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": { "name": "Paywise Data Enhance", "description": "Enhance Paywise Data & Performance: Improve Paywise data availability, reporting view speed, and content for users.", "team": "Data & BI" } },
                    { "Company Goal": "Go Global", "Working Capital": null, "Overhead Automation": { "name": "Booking Success Rate", "description": "Improve Booking Success Rate: Finalize reporting to identify reasons for failed/unattempted bookings, aiming to increase API booking percentage and invoice automation.", "team": "Finance" }, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null },
                    { "Company Goal": "Growing Online", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null },
                    { "Company Goal": "Put People First", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": { "name": "Launch Staff Circle", "description": "Launch Staff Circle within Finance Product: Initiate the Staff Circle program to prioritize people-centric initiatives within the team.", "team": "Finance" }, "Margin Control": null, "Efficiency Enhancement": null },
                    { "Company Goal": "Increase Margin", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": { "name": "Override Commissions Report", "description": "Report On-Invoice Override Commissions: Develop reports to highlight instances where on-invoice override commissions were not loaded, to minimize dilution and identify potential overpayments.", "team": "Finance" }, "Efficiency Enhancement": null },
                    { "Company Goal": "Build Loyalty", "Working Capital": null, "Overhead Automation": null, "Report Automation": null, "People Focus": null, "Margin Control": null, "Efficiency Enhancement": null }
                ]
            }
        };

        // Determine the order of months (Latest first for default)
        const MONTH_ORDER = ["SEP2025", "AUG2025", "JUL2025"];
        const DEFAULT_MONTH = MONTH_ORDER[0];

        // Global variables to store Chart instances for updates
        let workloadChartInstance = null;
        let requestorsChartInstance = null;
        let releaseTypeChartInstance = null;
        
        // --- RENDERING FUNCTIONS ---
        function destroyChartInstances() {
            if (workloadChartInstance) workloadChartInstance.destroy();
            if (requestorsChartInstance) requestorsChartInstance.destroy();
            if (releaseTypeChartInstance) releaseTypeChartInstance.destroy();
            workloadChartInstance = null;
            requestorsChartInstance = null;
            releaseTypeChartInstance = null;
        }

        function updateKPIs(data) {
            document.getElementById('report-period').textContent = `Reporting Period: For the month of ${data.reportDate}`;
            
            const kpiContainer = document.getElementById('kpi-container');
            kpiContainer.innerHTML = `
                <div class="kpi-card bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="text-sm font-medium text-slate-500">Strategic & Tactical Work</h3>
                    <p class="text-4xl font-bold text-amber-600 mt-2">${data.kpis.strategicTactical}</p>
                    <p class="text-xs text-slate-400 mt-1">of all work</p>
                </div>
                <div class="kpi-card bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="text-sm font-medium text-slate-500">Avg. Completion Time</h3>
                    <p class="text-4xl font-bold text-slate-800 mt-2">${data.kpis.avgCompletion} <span class="text-2xl">${data.kpiAvgCompletionUnit}</span></p>
                    <p class="text-xs text-slate-400 mt-1">for all completed work</p>
                </div>
                <div class="kpi-card bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="text-sm font-medium text-slate-500">Total Releases</h3>
                    <p class="text-4xl font-bold text-slate-800 mt-2">${data.kpis.totalReleases}</p>
                    <p class="text-xs text-slate-400 mt-1">total releases</p>
                </div>
                <div class="kpi-card bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="text-sm font-medium text-slate-500">Active Blockers</h3>
                    <p class="text-4xl font-bold ${data.kpis.activeBlockers > 1 ? 'text-red-600' : 'text-slate-800'} mt-2">${data.kpis.activeBlockers}</p>
                    <p class="text-xs text-slate-400 mt-1">requiring stakeholder action/decision</p>
                </div>
            `;
        }

        function populateLists(data) {
            // Key Achievements
            const achievementsList = document.getElementById('key-achievements-list');
            achievementsList.innerHTML = data.achievements.map(item => `
                <li class="flex items-start">
                    <span class="text-green-500 mr-3 mt-1">✔</span>
                    <div>
                        <h4 class="font-semibold">${item.summary}</h4>
                        <p class="text-slate-600 text-sm">${item.description}</p>
                    </div>
                </li>
            `).join('');

            // Blockers & Decisions
            const blockersDecisionsList = document.getElementById('blockers-decisions-list');
            blockersDecisionsList.innerHTML = data.blockers.map(item => `
                <li class="flex items-start">
                    <span class="${item.type === '❗' ? 'text-red-500' : item.type === '❓' ? 'text-blue-500' : 'text-orange-500'} mr-3 mt-1">${item.type}</span>
                    <div>
                        <h4 class="font-semibold">${item.title}</h4>
                        <p class="text-slate-600 text-sm">${item.description}</p>
                    </div>
                </li>
            `).join('');
            
            // Look Ahead (only applies to AUG2025 structure)
            const lookAheadSection = document.getElementById('ahead');
            const lookAheadContent = document.getElementById('look-ahead-content');
            
            if (data.ahead) {
                lookAheadSection.classList.remove('hidden');
                lookAheadContent.innerHTML = data.ahead.map(group => `
                    <ul class="space-y-4 text-slate-700">
                        <li>
                            <h4 class="font-semibold text-lg underline">${group.status}</h4>
                            <ul class="list-disc list-inside ml-4 space-y-1">
                                ${group.items.map(item => `
                                    <li><strong>${item.key}</strong> - ${item.summary} (Created: ${item.created})</li>
                                `).join('')}
                            </ul>
                        </li>
                    </ul>
                `).join('');
            } else {
                lookAheadSection.classList.add('hidden');
            }
        }

        function populateStrategicProgression(data) {
            const strategySection = document.getElementById('strategy');
            const listContainer = document.getElementById('strategic-progression-list');
            
            if (!data.strategicProgression) {
                // Scenario: Strategic Progression is OFFLINE (SEP2025)
                strategySection.classList.remove('hidden'); 
                listContainer.innerHTML = `
                    <div class="offline-marker">
                        <strong>Strategic Progression is an OFFLINE Report (Data not available in this format)</strong>
                    </div>
                `;
                return;
            }
            
            // Scenario: Strategic Progression is AVAILABLE (JUL2025/AUG2025)
            strategySection.classList.remove('hidden');
            listContainer.innerHTML = data.strategicProgression.map(item => {
                const getTrendData = (current, compare) => {
                    if (current === null || compare === null) return { icon: '━', color: 'text-slate-500', diff: 'N/A' };
                    const diff = current - compare;
                    const diffValue = diff !== 0 ? Math.abs(diff) : 0;
                    if (diff > 0) return { icon: '▲', color: 'text-green-600', diff: `${diffValue}%` };
                    if (diff < 0) return { icon: '▼', color: 'text-red-600', diff: `${diffValue}%` };
                    return { icon: '━', color: 'text-slate-500', diff: 'N/A' };
                };
                
                const prevTrend = getTrendData(item.current, item.previous);
                const lastYearTrend = getTrendData(item.current, item.lastYear);
                
                const barWidth = item.current;

                return `
                    <div class="p-4 bg-slate-50 rounded-lg border border-slate-100">
                        <div class="flex justify-between items-baseline mb-1">
                            <span class="text-base font-medium text-slate-700">${item.name}</span>
                            <span class="text-lg font-bold text-slate-900 current-value-display">${item.current}%</span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-1">
                            <div class="progression-bar" style="width: ${barWidth}%"></div>
                        </div>
                        <p class="text-sm text-slate-500 mt-2">
                            <span class="trend-comparison" data-compare-to="previous" data-label="vs. Last Month">vs. Last Month: <span class="font-bold ${prevTrend.color}">${prevTrend.icon} ${prevTrend.diff}</span></span> | 
                            <span class="trend-comparison" data-compare-to="last-year" data-label="vs. Last Year">vs. Last Year: <span class="font-bold ${lastYearTrend.color}">${lastYearTrend.icon} ${lastYearTrend.diff}</span></span>
                            <br>Tangible Improvement: ${item.improvement}
                        </p>
                    </div>
                `;
            }).join('');
        }

        function updateCharts(jiraData) {
            destroyChartInstances(); // Destroy existing charts first

            const chartConfig = {
                tooltip: {
                    bodyFont: { size: 14 }, titleFont: { size: 16, weight: 'bold' }, padding: 12,
                    backgroundColor: 'rgba(15, 23, 42, 0.8)', boxPadding: 4,
                },
                legends: {
                    position: 'bottom', labels: { font: { size: 12, family: 'Inter' }, padding: 20, color: '#475569' }
                }
            };

            // Workload Breakdown Chart (Doughnut)
            const workloadCtx = document.getElementById('workloadChart').getContext('2d');
            workloadChartInstance = new Chart(workloadCtx, {
                type: 'doughnut',
                data: {
                    labels: jiraData.workloadLabels,
                    datasets: [{
                        label: 'Workload %',
                        data: jiraData.workloadCounts,
                        backgroundColor: ['#f59e0b', '#64748b', '#94a3b8', '#cbd5e1', '#71717a'],
                        borderColor: '#f8fafc', borderWidth: 4, hoverOffset: 8
                    }]
                },
                options: { plugins: { legend: chartConfig.legends, tooltip: chartConfig.tooltip } }
            });

            // Primary Requestors Chart (Bar)
            const sortedRequestors = jiraData.requestorLabels.map((label, i) => ({ label, count: jiraData.requestorCounts[i] })).sort((a, b) => b.count - a.count);
            const requestorsCtx = document.getElementById('requestorsChart').getContext('2d');
            requestorsChartInstance = new Chart(requestorsCtx, {
                type: 'bar',
                data: {
                    labels: sortedRequestors.map(r => r.label),
                    datasets: [{
                        label: 'Number of Requests',
                        data: sortedRequestors.map(r => r.count),
                        backgroundColor: '#f59e0b', borderColor: '#d97706', borderWidth: 1, borderRadius: 4,
                    }]
                },
                options: {
                    indexAxis: 'y', plugins: { legend: { display: false }, tooltip: chartConfig.tooltip },
                    scales: { x: { beginAtZero: true, grid: { display: false } }, y: { grid: { color: '#e2e8f0' } } }
                }
            });
            
            // Product Release Types Chart (Doughnut)
            const releaseTypeCtx = document.getElementById('releaseTypeChart').getContext('2d');
            releaseTypeChartInstance = new Chart(releaseTypeCtx, {
                type: 'doughnut',
                data: {
                    labels: jiraData.releaseTypeLabels,
                    datasets: [{
                        label: 'Number of Releases',
                        data: jiraData.releaseTypeCounts,
                        backgroundColor: ['#f59e0b', '#d97706', '#a16207', '#64748b', '#94a3b8', '#475569', '#71717a', '#334155'],
                        borderColor: '#f8fafc', borderWidth: 4, hoverOffset: 8
                    }]
                },
                options: { plugins: { legend: chartConfig.legends, tooltip: chartConfig.tooltip } }
            });

            document.getElementById('total-tickets-closed').textContent = jiraData.releases.length;
        }

        function populateReleases(data) {
            document.getElementById('releases-header').textContent = `Recent Product Releases (${data.reportDate})`;
            const releaseListContainer = document.getElementById('release-list-container');
            releaseListContainer.innerHTML = '';

            const groupedReleases = data.jira.releases.reduce((groups, ticket) => {
                const type = ticket["Request Type"];
                if (!groups[type]) groups[type] = [];
                groups[type].push(ticket);
                return groups;
            }, {});

            for (const type in groupedReleases) {
                const releaseGroupDiv = document.createElement('div');
                releaseGroupDiv.className = 'release-type-group p-4';
                releaseGroupDiv.innerHTML = `<h3>${type}</h3><ul></ul>`;
                const ul = releaseGroupDiv.querySelector('ul');

                groupedReleases[type].forEach(ticket => {
                    const li = document.createElement('li');
                    li.className = 'release-item';
                    const star = ticket.is_key_release ? '<span class="key-release-star">⭐</span>' : '';
                    // Use optional chaining for safer access, though all fields seem present now
                    const description = `Requestor: ${ticket.Requestor ?? 'N/A'} | Created: ${ticket['Created Date'] ?? 'N/A'} | Resolved: ${ticket['Resolved Date'] ?? 'N/A'} | Work Type: ${ticket['Work Type'] ?? 'N/A'} | SP: ${ticket['Story Points'] ?? '--'}`;
                    li.innerHTML = `${star}${description}<strong>${ticket.Summary}</strong>`;
                    ul.appendChild(li);
                });
                releaseListContainer.appendChild(releaseGroupDiv);
            }
        }

        function populatePriorities(data) {
            const prioritiesSection = document.getElementById('priorities');
            prioritiesSection.innerHTML = data.prioritiesContentHTML;

            const tableBody = prioritiesSection.querySelector('.priority-table tbody');
            tableBody.innerHTML = '';

            const companyGoalOrder = [
                "Cross-functional / Finance Specific", "Gain Efficiency", "Go Global", "Growing Online",
                "Put People First", "Increase Margin", "Build Loyalty"
            ];

            const financeGoalColumns = [
                "Working Capital", "Overhead Automation", "Report Automation", "People Focus",
                "Margin Control", "Efficiency Enhancement"
            ];

            const teamColorMap = {
                "Data & BI": "team-data-bi", "Booking & Fulfilment": "team-booking-fulfilment", "Finance": "team-finance",
                "CRM": "team-crm", "B&F": "team-booking-fulfilment", "none": "priority-bubble"
            };

            data.priorities.forEach(p => {
                const row = document.createElement('tr');
                const companyGoalCell = document.createElement('td');
                companyGoalCell.innerHTML = `<span class="font-semibold text-slate-800">${p["Company Goal"]}</span>`;
                row.appendChild(companyGoalCell);

                financeGoalColumns.forEach(financeGoal => {
                    const td = document.createElement('td');
                    const priorityData = p[financeGoal];
                    if (priorityData && priorityData.name) {
                        const teamClass = teamColorMap[priorityData.team] || 'priority-bubble';
                        const topFocusClass = priorityData.isTopFocus ? 'priority-top-focus' : '';
                        const bubbleSpan = document.createElement('span');
                        bubbleSpan.className = `priority-bubble ${teamClass} ${topFocusClass}`.trim();
                        bubbleSpan.setAttribute('data-tooltip-content', priorityData.description);
                        // Use split to shorten long priority names for display
                        const shortName = priorityData.name.split(' - ')[0].trim();
                        bubbleSpan.textContent = shortName;
                        td.appendChild(bubbleSpan);
                    }
                    row.appendChild(td);
                });

                const teamCell = document.createElement('td');
                row.appendChild(teamCell);
                tableBody.appendChild(row);
            });
            // Re-attach tooltip listeners after updating the DOM
            attachTooltipListeners();
        }
        
        function attachTooltipListeners() {
            const customTooltip = document.getElementById('custom-tooltip');
            
            document.querySelectorAll('.priority-bubble').forEach(bubble => {
                bubble.removeEventListener('mouseenter', bubble._mouseEnterHandler);
                bubble.removeEventListener('mouseleave', bubble._mouseLeaveHandler);
            });

            document.querySelectorAll('.priority-bubble').forEach(bubble => {
                bubble._mouseEnterHandler = (e) => {
                    const content = e.target.dataset.tooltipContent;
                    if (content) {
                        clearTimeout(bubble.tooltipTimeout); 
                        bubble.tooltipTimeout = setTimeout(() => {
                            customTooltip.innerHTML = content;
                            customTooltip.classList.add('visible'); customTooltip.classList.remove('hidden');

                            const rect = e.target.getBoundingClientRect();
                            const scrollY = window.scrollY || window.pageYOffset;
                            let leftPos = rect.left + (rect.width / 2) - (customTooltip.offsetWidth / 2);
                            let topPos = rect.top + scrollY - customTooltip.offsetHeight - 10;

                            if (leftPos < 0) leftPos = 10;
                            if (leftPos + customTooltip.offsetWidth > window.innerWidth) leftPos = window.innerWidth - customTooltip.offsetWidth - 10;
                            if (topPos < 0) topPos = rect.bottom + scrollY + 10;

                            customTooltip.style.left = `${leftPos}px`;
                            customTooltip.style.top = `${topPos}px`;
                        }, 500);
                    }
                };

                bubble._mouseLeaveHandler = () => {
                    clearTimeout(bubble.tooltipTimeout);
                    customTooltip.classList.remove('visible'); customTooltip.classList.add('hidden');
                };

                bubble.addEventListener('mouseenter', bubble._mouseEnterHandler);
                bubble.addEventListener('mouseleave', bubble._mouseLeaveHandler);
            });
        }
        
        function setupNavigation(data) {
            const navContainer = document.getElementById('main-nav-container');
            const mainContent = document.getElementById('content');
            
            // Insert the correct navigation HTML
            navContainer.innerHTML = data.navLinksHTML;
            
            // Re-attach listeners to the new navigation links
            const navLinks = navContainer.querySelectorAll('.nav-link');
            const contentSections = mainContent.querySelectorAll('.content-section');
            
            const navigateTo = (hash) => {
                navLinks.forEach(link => link.classList.remove('active'));
                contentSections.forEach(section => section.classList.add('hidden'));

                const targetId = hash.substring(1);
                const targetLink = navContainer.querySelector(`[href="${hash}"]`);
                const targetSection = document.getElementById(targetId);

                if (targetLink) targetLink.classList.add('active');
                if (targetSection) targetSection.classList.remove('hidden');
            };

            navLinks.forEach(link => {
                link.removeEventListener('click', link._navClickHandler); 
                
                link._navClickHandler = (e) => {
                    e.preventDefault();
                    const targetHash = e.currentTarget.hash;
                    navigateTo(targetHash);
                    window.history.pushState(null, null, targetHash);
                };
                
                link.addEventListener('click', link._navClickHandler);
            });
            
            return navigateTo;
        }

        function renderDashboard(monthKey, initialHash) {
            const data = ALL_MONTHLY_DATA[monthKey];
            if (!data) return console.error("Data for month " + monthKey + " not found.");

            const navigateTo = setupNavigation(data);
            
            updateKPIs(data);
            populateLists(data);
            populateStrategicProgression(data);
            populateReleases(data);
            populatePriorities(data);
            updateCharts(data.jira);

            const currentHash = initialHash || window.location.hash || '#overview';
            navigateTo(currentHash);
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', function () {
            
            const selector = document.getElementById('month-selector');
            MONTH_ORDER.forEach(month => {
                const option = document.createElement('option');
                option.value = month;
                option.textContent = month;
                selector.appendChild(option);
            });

            selector.value = DEFAULT_MONTH;
            const initialHash = window.location.hash || '#overview';
            renderDashboard(DEFAULT_MONTH, initialHash);

            selector.addEventListener('change', function() {
                const currentActiveLink = document.querySelector('#main-nav-container .nav-link.active');
                const activeHash = currentActiveLink ? currentActiveLink.hash : '#overview';

                renderDashboard(selector.value, activeHash);
            });
        });
    </script>
</body>
</html>
